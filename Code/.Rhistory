labs(shape= "Compartment", color= "Site") +
xlab(paste("PCoA", axis1, sub(".*\\ ", "", temp$labels$x))) +
ylab(paste("PCoA", axis2, sub(".*\\ ", "", temp$labels$y))) +
guides(fill = guide_legend(override.aes = c(shape = 21, alpha = 1)), color = guide_legend(override.aes = c(alpha=1)))
return(Plot)
} else if(split_by == 'rootstock'){
temp <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2))
temp[["layers"]][[1]][["geom"]][["default_aes"]][["colour"]] <- "white" # make the plot_ordination points white to allow me to use alpha without them showing through.
Plot <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2)) +
geom_point(aes(fill=rootstock, shape=plant_body_site), size = 5, alpha = 0.80, color = "black") +
scale_shape_manual(values=c(22, 24, 21)) +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
labs(shape= "Compartment", color= "Site") +
xlab(paste("PCoA", axis1, sub(".*\\ ", "", temp$labels$x))) +
ylab(paste("PCoA", axis2, sub(".*\\ ", "", temp$labels$y))) +
guides(fill = guide_legend(override.aes = c(shape = 21, alpha = 1)), color = guide_legend(override.aes = c(alpha=1)))
return(Plot)
} else if(split_by == 'scion'){
temp <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2))
temp[["layers"]][[1]][["geom"]][["default_aes"]][["colour"]] <- "white" # make the plot_ordination points white to allow me to use alpha without them showing through.
Plot <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2)) +
geom_point(aes(fill=scion, shape=plant_body_site), size = 5, alpha = 0.80, color = "black") +
scale_shape_manual(values=c(22, 24, 21)) +
scale_fill_manual(name = "Scion", values=scion_palette) +
labs(shape= "Compartment", color= "Site") +
xlab(paste("PCoA", axis1, sub(".*\\ ", "", temp$labels$x))) +
ylab(paste("PCoA", axis2, sub(".*\\ ", "", temp$labels$y))) +
guides(fill = guide_legend(override.aes = c(shape = 21, alpha = 1)), color = guide_legend(override.aes = c(alpha=1)))
return(Plot)
} else if(split_by == 'year'){
temp <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2))
temp[["layers"]][[1]][["geom"]][["default_aes"]][["colour"]] <- "white" # make the plot_ordination points white to allow me to use alpha without them showing through.
Plot <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2)) +
geom_point(aes(fill=year, shape=plant_body_site), size = 5, alpha = 0.80, color = "black") +
scale_shape_manual(values=c(22, 24, 21)) +
#scale_fill_manual(name = "Scion", values=scion_palette) +
labs(shape= "Compartment", color= "Site") +
xlab(paste("PCoA", axis1, sub(".*\\ ", "", temp$labels$x))) +
ylab(paste("PCoA", axis2, sub(".*\\ ", "", temp$labels$y))) +
guides(fill = guide_legend(override.aes = c(shape = 21, alpha = 1)), color = guide_legend(override.aes = c(alpha=1)))
return(Plot)
}  else if(split_by == 'col_week'){
temp <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2))
temp[["layers"]][[1]][["geom"]][["default_aes"]][["colour"]] <- "white" # make the plot_ordination points white to allow me to use alpha without them showing through.
Plot <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2)) +
geom_point(aes(fill=col_week, shape=plant_body_site), size = 5, alpha = 0.80, color = "black") +
scale_shape_manual(values=c(22, 24, 21)) +
#scale_fill_manual(name = "Scion", values=scion_palette) +
labs(shape= "Compartment", color= "Site") +
xlab(paste("PCoA", axis1, sub(".*\\ ", "", temp$labels$x))) +
ylab(paste("PCoA", axis2, sub(".*\\ ", "", temp$labels$y))) +
guides(fill = guide_legend(override.aes = c(shape = 21, alpha = 1)), color = guide_legend(override.aes = c(alpha=1)))
return(Plot)
}   else if(split_by == 'block'){
temp <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2))
temp[["layers"]][[1]][["geom"]][["default_aes"]][["colour"]] <- "white" # make the plot_ordination points white to allow me to use alpha without them showing through.
Plot <- plot_ordination(plot_data, distance_matrix, axes = c(axis1,axis2)) +
geom_point(aes(fill=block, shape=plant_body_site), size = 5, alpha = 0.80, color = "black") +
scale_shape_manual(values=c(22, 24, 21)) +
#scale_fill_manual(name = "Scion", values=scion_palette) +
labs(shape= "Compartment", color= "Site") +
xlab(paste("PCoA", axis1, sub(".*\\ ", "", temp$labels$x))) +
ylab(paste("PCoA", axis2, sub(".*\\ ", "", temp$labels$y))) +
guides(fill = guide_legend(override.aes = list(shape = 21)), shape = guide_legend(override.aes = list(fill = "black")))
return(Plot)
}
}
# Given a phyloseq object, return a dataframe of the sample metadata
# From: https://jacobrprice.github.io/2017/08/26/phyloseq-to-vegan-and-back.html
pssd2veg <- function(physeq) {
sd <- sample_data(physeq)
return(as(sd,"data.frame"))
}
# load dataset generated from Data_filtering_normalization.R
phy_vst <- readRDS("../Data_files/phyloseq_16s_no_soil_filtered_vst_dataset.rds")
##### 1.0) ALPHA DIVERSITY ANALYSIS #####
alpha_diversity.df <- Alpha_div_metrics(phy_vst)
# Lmer models
fphd_16s_fit.mod <- lmerTest::lmer(Faithpd ~ rootstock*scion + plant_body_site*brix + year + site + (1|sequence_depth), data = alpha_diversity.df)
simpI_16s_fit.mod <- lmerTest::lmer(Invsimpson ~ rootstock*scion + plant_body_site*brix + year + site + (1|sequence_depth), data = alpha_diversity.df)
chao1_16s_fit.mod <- lmerTest::lmer(Chao1 ~ rootstock*scion + plant_body_site*brix + year + site + (1|sequence_depth), data = alpha_diversity.df)
# anovas, paste these into excel
anova(fphd_16s_fit.mod)
anova(simpI_16s_fit.mod)
anova(chao1_16s_fit.mod)
# check the random effects
rand(fphd_16s_fit.mod)
rand(simpI_16s_fit.mod)
rand(chao1_16s_fit.mod)
# posthocs
pairs(emmeans(fphd_16s_fit.mod, ~ rootstock))
pairs(emmeans(fphd_16s_fit.mod, ~ plant_body_site))
pairs(emmeans(fphd_16s_fit.mod, ~ year))
pairs(emmeans(fphd_16s_fit.mod, ~ site))
pairs(emmeans(fphd_16s_fit.mod, ~ rootstock|scion))
pairs(emmeans(simpI_16s_fit.mod, ~ plant_body_site))
pairs(emmeans(simpI_16s_fit.mod, ~ year))
pairs(emmeans(simpI_16s_fit.mod, ~ site))
pairs(emmeans(simpI_16s_fit.mod, ~ rootstock|scion))
pairs(emmeans(chao1_16s_fit.mod, ~ rootstock))
pairs(emmeans(chao1_16s_fit.mod, ~ plant_body_site))
pairs(emmeans(chao1_16s_fit.mod, ~ year))
pairs(emmeans(chao1_16s_fit.mod, ~ site))
pairs(emmeans(chao1_16s_fit.mod, ~ rootstock|scion))
##### Supplemental Figure 2 #####
# Discretizing sugar content values
Brix_values <- as.data.frame(phy_vst@sam_data)
Brix_spilt_plot <- ggplot(Brix_values[Brix_values$plant_body_site == "berry",], aes(x = 1:184, y = brix)) +
geom_point()  + geom_hline(yintercept = 7, color = "red", linetype = 'dashed') +
xlab("Index") + ylab("Sugar content (\u00B0Bx)")
ggsave("Brix_discret_split_plot.svg", Brix_spilt_plot, bg = 'white', dpi = 600, height = 8, width = 6)
ggsave("Brix_discret_split_plot.pdf", Brix_spilt_plot, bg = 'white', dpi = 600, height = 8, width = 6)
###### Figure 1 B and C ######
# Load Brix data set from CA_Brix_2018-2019.R
Brixdf <- readRDS("../Data_files/CA_Brix_2018-2019.rds")
# 2018
bx2018 <- ggplot(Brixdf[Brixdf$Year == "2018",], aes(x=Sample.Date, y=brix, color = Scion)) +
annotate("rect", fill = "black", alpha= 0.5, xmin=as.Date("2018-06-19"), xmax=as.Date("2018-06-21"), ymin=-Inf, ymax=Inf) +
annotate("rect", fill = "black", alpha= 0.5, xmin=as.Date("2018-07-10"), xmax=as.Date("2018-07-13"), ymin=-Inf, ymax=Inf) +
annotate("rect", fill = "black", alpha= 0.5, xmin=as.Date("2018-07-31"), xmax=as.Date("2018-08-02"), ymin=-Inf, ymax=Inf) +
geom_smooth(method = "loess", level=0.95, size = 1, se=TRUE) +
scale_color_manual(values = scion_palette) +
#scale_y_continuous(breaks = seq(1,25,4)) +
scale_x_date(limits = as.Date(c("2018-06-15","2018-08-10"))) +
#\u00B0 makes the degree symbol#
ylab("Sugar content (\u00B0Bx)") +
ylim(3, 23) +
theme(legend.position = "right", axis.title.x=element_blank()) +
ggtitle("2018")
# 2019
bx2019 <- ggplot(Brixdf[Brixdf$Year == "2019",], aes(x=Sample.Date, y=brix, color = Scion)) +
annotate("rect", fill = "black", alpha= 0.5, xmin=as.Date("2019-06-25"), xmax=as.Date("2019-06-27"), ymin=-Inf, ymax=Inf) +
annotate("rect", fill = "black", alpha= 0.5, xmin=as.Date("2019-07-23"), xmax=as.Date("2019-07-25"), ymin=-Inf, ymax=Inf) +
geom_smooth(method = "loess", level=0.95, size = 1, se=TRUE) +
scale_color_manual(values = scion_palette) +
#scale_y_continuous(breaks = seq(1,25,4)) +
scale_x_date(limits = as.Date(c("2019-06-15","2019-08-10"))) +
#\u00B0 makes the degree symbol#
ylab("Sugar content (\u00B0Bx)") +
ylim(3, 23) +
theme(legend.position = "right", axis.title.x=element_blank()) +
ggtitle("2019")
# Brix statistics | Berry only
alpha_berries <- alpha_diversity.df[alpha_diversity.df$plant_body_site == 'berry',]
brix_berry.mod <- lm(brix ~ rootstock + lower_political + scion*col_week, data = alpha_berries) # Model brix data with rootstock, scion, and scion*col_week
car::Anova(brix_berry.mod , type = "III") # anova type III because of interaction
pairs(emmeans(brix_berry.mod , ~ lower_political)) # San joaquin lower than others.
pairs(emmeans(brix_berry.mod , ~ scion|col_week)) # chard and cab diverge later in season
shan_berry_brix.mod <- lmerTest::lmer(Shannon ~ rootstock + scion + site + brix + brix:year + (1|sequence_depth) + (1|seq_plate), data = alpha_berries)
performance::check_collinearity(shan_berry_brix.mod)
anova(shan_berry_brix.mod)
pairs(emtrends(shan_berry_brix.mod, 'year', var = "brix"))
# Roots
alpha_root <- alpha_diversity.df[alpha_diversity.df$plant_body_site == 'root',]
ggplot(alpha_root, aes(x=brix, y=Shannon, fill=year)) + geom_point(shape=21, size =3) + geom_smooth(method = 'lm') #+ facet_wrap(~col_week)
# Leaves
alpha_leaf <- alpha_diversity.df[alpha_diversity.df$plant_body_site == 'leaf',]
ggplot(alpha_leaf, aes(x=brix, y=Shannon, fill=year)) + geom_point(shape=21, size =3) + geom_smooth(method = 'lm') #+ facet_wrap(~col_week)
####### Figure 3 ######
# alpha diversity (Faith across compartments)
# Make a tibble to store where to place significance letters from the Tukey test
labels_df <- tibble(plant_body_site=levels(alpha_diversity.df$plant_body_site), rootstock=levels(alpha_diversity.df$rootstock), Mfaith=max(alpha_diversity.df$Faithpd) * 1.2)
TukeyHSD(aov(Faithpd ~ plant_body_site, data = alpha_diversity.df), conf.level = 0.95)
fig3A <- ggplot(alpha_diversity.df, aes(plant_body_site, Faithpd, fill = plant_body_site)) +
geom_jitter(width = 0.25, color = "black") +
xlab ("Compartment") +
geom_boxplot(outlier.shape = NA, alpha = 0.8) +
theme(legend.position = "top") +
ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name="Compartment", breaks=c("berry", "leaf", "root"),
labels=c("Berry","Leaf", "Root"), values = compartment_palette) +
scale_x_discrete(breaks=c("berry", "leaf", "root"), labels=c("Berry", "Leaf", "Root")) +
geom_text(data=labels_df, aes(plant_body_site, Mfaith, label=c("a","a","b")), size = 6)
fig3A
fig3A <- ggplot(alpha_diversity.df, aes(plant_body_site, Faithpd, fill = plant_body_site)) +
geom_jitter(width = 0.25, color = "black") +
xlab ("Compartment") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") +
theme(legend.position = "top") +
ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name="Compartment", breaks=c("berry", "leaf", "root"),
labels=c("Berry","Leaf", "Root"), values = compartment_palette) +
scale_x_discrete(breaks=c("berry", "leaf", "root"), labels=c("Berry", "Leaf", "Root")) +
geom_text(data=labels_df, aes(plant_body_site, Mfaith, label=c("a","a","b")), size = 6)
fig3A
ggplot(alpha_diversity.df, aes(plant_body_site, Faithpd, fill = plant_body_site))
ggplot(alpha_diversity.df, aes(plant_body_site, Faithpd, fill = plant_body_site)) +
geom_jitter(width = 0.25, color = "black")
ggplot(alpha_diversity.df, aes(plant_body_site, Faithpd, fill = plant_body_site)) +
geom_jitter(width = 0.25, color = "black") +
xlab ("Compartment") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black")
ggplot(alpha_diversity.df, aes(plant_body_site, Faithpd, fill = plant_body_site)) +
geom_jitter(width = 0.25, color = "black") +
xlab ("Compartment") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") +
theme(legend.position = "top") +
ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name="Compartment", breaks=c("berry", "leaf", "root"),
labels=c("Berry","Leaf", "Root"), values = compartment_palette) +
scale_x_discrete(breaks=c("berry", "leaf", "root"), labels=c("Berry", "Leaf", "Root"))
ggplot(alpha_diversity.df, aes(plant_body_site, Faithpd, fill = plant_body_site)) +
geom_jitter(width = 0.25, color = "black") +
xlab ("Compartment") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") +
theme(legend.position = "top") +
ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name="Compartment", breaks=c("berry", "leaf", "root"),
labels=c("Berry","Leaf", "Root"), values = compartment_palette) +
scale_x_discrete(breaks=c("berry", "leaf", "root"), labels=c("Berry", "Leaf", "Root")) +
geom_text(data=labels_df, aes(plant_body_site, Mfaith, label=c("a","a","b")), size = 6)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
#geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock, group = scion)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
#geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion)
fig3B <- ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion)
fig3 <- ggarrange(fig3A,fig3B, labels = c('A', 'B'))
fig3
# Boxplot of scion X rootstock X compartment faith
levels(alpha_diversity.df$scion)
# Boxplot of scion X rootstock X compartment faith
facet_label <- c("cabernet sauvignon", "chardonnay")
# Boxplot of scion X rootstock X compartment faith
facet_label <- c("Cabernet Sauvignon", "Chardonnay")
fig3B <- ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = facet_label)
fig3B
# Boxplot of scion X rootstock X compartment faith
levels(alpha_diversity.df$scion)
names(facet_label) <- c("cabernet sauvignon", "chardonnay")
facet_label
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = facet_label)
rlang::last_error()
facet_label
c("Cabernet Sauvignon", "Chardonnay")
# Boxplot of scion X rootstock X compartment faith
facet_label <- c("Cabernet Sauvignon", "Chardonnay")
facet_label
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = facet_label)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
# Boxplot of scion X rootstock X compartment faith
facet_label <- c("Cabernet Sauvignon", "Chardonnay")
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
# Boxplot of scion X rootstock X compartment faith
facet_label <- c("Cabernet Sauvignon", "Chardonnay")
names(facet_label) <- c("cabernet sauvignon", "chardonnay")
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
pairs(emmeans(fphd_16s_fit.mod, ~ rootstock|scion))
ggplot(alpha_diversity.df, aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
pairs(emmeans(fphd_16s_fit.mod, ~ rootstock|scion|plant_body_site))
pairs(emmeans(fphd_16s_fit.mod, ~ rootstock|scion*plant_body_site))
pairs(emmeans(fphd_16s_fit.mod, ~ rootstock|scion|plant_body_site))
pairs(emmeans(fphd_16s_fit.mod, ~ rootstock|plant_body_site))
pairs(emmeans(fphd_16s_fit.mod, ~ rootstock|scion|plant_body_site))
pairs(emmeans(fphd_16s_fit.mod, ~ rootstock|scion))
ggplot(alpha_diversity.df, aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
####### Figure 3 ######
# alpha diversity (Faith across compartments)
# Make a tibble to store where to place significance letters from the Tukey test
labels_df <- tibble(plant_body_site=levels(alpha_diversity.df$plant_body_site), rootstock=levels(alpha_diversity.df$rootstock), Mfaith=max(alpha_diversity.df$Faithpd) * 1.2)
TukeyHSD(aov(Faithpd ~ plant_body_site, data = alpha_diversity.df), conf.level = 0.95)
fig3A <- ggplot(alpha_diversity.df, aes(plant_body_site, Faithpd, fill = plant_body_site)) +
geom_jitter(width = 0.25, color = "black") +
xlab ("Compartment") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") +
theme(legend.position = "top") +
ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name="Compartment", breaks=c("berry", "leaf", "root"),
labels=c("Berry","Leaf", "Root"), values = compartment_palette) +
scale_x_discrete(breaks=c("berry", "leaf", "root"), labels=c("Berry", "Leaf", "Root")) +
geom_text(data=labels_df, aes(plant_body_site, Mfaith, label=c("a","a","b")), size = 6)
fig3A
# Stats mean faith for compartments for main text
mean(alpha_diversity.df[alpha_diversity.df$plant_body_site == 'berry',]$Faithpd) #4.633959
mean(alpha_diversity.df[alpha_diversity.df$plant_body_site == 'leaf',]$Faithpd) #5.709501
mean(alpha_diversity.df[alpha_diversity.df$plant_body_site == 'root',]$Faithpd) #61.06594
# Boxplot of scion X rootstock X compartment faith
facet_label <- c("Cabernet Sauvignon", "Chardonnay")
names(facet_label) <- c("cabernet sauvignon", "chardonnay")
fig3B <- ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
fig3 <- ggarrange(fig3A,fig3B, labels = c('A', 'B'))
#
ggsave("figure3_faith_by_compartment_and_rootsock-scion.svg", fig2, height = 6, width = 10, bg = 'white', dpi = 1200)
ggsave("figure3_faith_by_compartment_and_rootsock-scion.pdf", fig2, height = 6, width = 10)
# Stats
# We found that Teleki 5C showed lower alpha diversity (faith) than the other rootstocks,
# this was particularly apparent in the root samples. Below are some summary stats for the
# rootstocks. It seems that at Merced in particular the values are much lower than the mean
# for other rootstocks and even the scion/rootstock combo at another site.
summarySE(alpha_diversity.df, measurevar = "Faithpd", groupvars = c("plant_body_site", "rootstock", "scion"))
summarySE(alpha_diversity.df, measurevar = "Faithpd", groupvars = c("plant_body_site", "rootstock", "scion", "site"))
# Stats
# We found that Teleki 5C showed lower alpha diversity (faith) than the other rootstocks,
# this was particularly apparent in the root samples. Below are some summary stats for the
# rootstocks. It seems that at Merced in particular the values are much lower than the mean
# for other rootstocks and even the scion/rootstock combo at another site.
summarySE(alpha_diversity.df, measurevar = "Faithpd", groupvars = c("plant_body_site", "rootstock", "scion"))
summarySE(alpha_diversity.df, measurevar = "Faithpd", groupvars = c("plant_body_site", "rootstock", "scion", "site"))
fig3
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion*site)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion+site)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
#geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion+site)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_boxplot(outlier.shape = NA)+ xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
geom_jitter(width = 0.2, color = "black") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_jitter(width = 0.2, color = "black") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") + xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
fig3B <- ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_jitter(width = 0.2, color = "black") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") + xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
fig3 <- ggarrange(fig3A,fig3B, labels = c('A', 'B'))
#
ggsave("figure3_faith_by_compartment_and_rootsock-scion.svg", fig2, height = 6, width = 10, bg = 'white', dpi = 1200)
####### Figure 3 ######
# alpha diversity (Faith across compartments)
# Make a tibble to store where to place significance letters from the Tukey test
labels_df <- tibble(plant_body_site=levels(alpha_diversity.df$plant_body_site), rootstock=levels(alpha_diversity.df$rootstock), Mfaith=max(alpha_diversity.df$Faithpd) * 1.2)
TukeyHSD(aov(Faithpd ~ plant_body_site, data = alpha_diversity.df), conf.level = 0.95)
fig3A <- ggplot(alpha_diversity.df, aes(plant_body_site, Faithpd, fill = plant_body_site)) +
geom_jitter(width = 0.25, color = "black") +
xlab ("Compartment") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") +
theme(legend.position = "top") +
ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name="Compartment", breaks=c("berry", "leaf", "root"),
labels=c("Berry","Leaf", "Root"), values = compartment_palette) +
scale_x_discrete(breaks=c("berry", "leaf", "root"), labels=c("Berry", "Leaf", "Root")) +
geom_text(data=labels_df, aes(plant_body_site, Mfaith, label=c("a","a","b")), size = 6)
# Stats mean faith for compartments for main text
mean(alpha_diversity.df[alpha_diversity.df$plant_body_site == 'berry',]$Faithpd) #4.633959
mean(alpha_diversity.df[alpha_diversity.df$plant_body_site == 'leaf',]$Faithpd) #5.709501
mean(alpha_diversity.df[alpha_diversity.df$plant_body_site == 'root',]$Faithpd) #61.06594
# Boxplot of scion X rootstock X compartment faith
facet_label <- c("Cabernet Sauvignon", "Chardonnay")
names(facet_label) <- c("cabernet sauvignon", "chardonnay")
fig3B <- ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_jitter(width = 0.2, color = "black") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") + xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label))
fig3 <- ggarrange(fig3A,fig3B, labels = c('A', 'B'))
#
ggsave("figure3_faith_by_compartment_and_rootsock-scion.svg", fig3, height = 6, width = 10, bg = 'white', dpi = 1200)
ggsave("figure3_faith_by_compartment_and_rootsock-scion.pdf", fig3, height = 6, width = 10)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_jitter(width = 0.2, color = "black") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") + xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label)) +
theme(axis.text.x = element_blank())
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_jitter(width = 0.2, color = "black") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") + xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label)) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())
fig3B <- ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_jitter(width = 0.2, color = "black") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") + xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("a","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label)) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())
fig3 <- ggarrange(fig3A,fig3B, labels = c('A', 'B'))
#
ggsave("figure3_faith_by_compartment_and_rootsock-scion.svg", fig3, height = 6, width = 10, bg = 'white', dpi = 1200)
ggsave("figure3_faith_by_compartment_and_rootsock-scion.pdf", fig3, height = 6, width = 10)
fig3 <- ggarrange(fig3A,fig3B, labels = c('A', 'B'), align = "hv")
#
ggsave("figure3_faith_by_compartment_and_rootsock-scion.svg", fig3, height = 6, width = 10, bg = 'white', dpi = 1200)
ggsave("figure3_faith_by_compartment_and_rootsock-scion.pdf", fig3, height = 6, width = 10)
lmerTest::lmer(Faithpd ~ rootstock*scion + plant_body_site*brix + year + site + (1|sequence_depth), data = alpha_diversity.df)
fig3B <- ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_jitter(width = 0.2, color = "black") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") + xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
facet_wrap(~scion, labeller = labeller(scion = facet_label)) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())
fig3 <- ggarrange(fig3A,fig3B, labels = c('A', 'B'), align = "hv")
#
ggsave("figure3_faith_by_compartment_and_rootsock-scion.svg", fig3, height = 6, width = 10, bg = 'white', dpi = 1200)
ggsave("figure3_faith_by_compartment_and_rootsock-scion.pdf", fig3, height = 6, width = 10)
TukeyHSD(aov(Faithpd ~ rootstock*scion, data = alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",]), conf.level = 0.95)
ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_jitter(width = 0.2, color = "black") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") + xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("ab","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label)) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())
fig3B <- ggplot(alpha_diversity.df[alpha_diversity.df$plant_body_site == "root",], aes(x=rootstock, y=Faithpd,  fill=rootstock)) +
geom_jitter(width = 0.2, color = "black") +
geom_boxplot(outlier.shape = NA, alpha = 0.8, color = "black") + xlab ("Rootstock") + ylab("Faith's phylogenetic diversity") +
scale_fill_manual(name = "Rootstock", values=rootstock_palette) +
geom_text(data=labels_df, aes(rootstock, Mfaith, label=c("ab","a","a","a","a","b")), size = 6) + ylim(0, NA) +
facet_wrap(~scion, labeller = labeller(scion = facet_label)) +
theme(axis.text.x = element_blank(), axis.ticks.x = element_blank())
fig3 <- ggarrange(fig3A,fig3B, labels = c('A', 'B'), align = "hv")
#
ggsave("figure3_faith_by_compartment_and_rootsock-scion.svg", fig3, height = 6, width = 10, bg = 'white', dpi = 1200)
ggsave("figure3_faith_by_compartment_and_rootsock-scion.pdf", fig3, height = 6, width = 10)
fig3 <- ggarrange(fig3A,fig3B, labels = c('A', 'B'))
#
ggsave("figure3_faith_by_compartment_and_rootsock-scion.svg", fig3, height = 6, width = 10, bg = 'white', dpi = 1200)
ggsave("figure3_faith_by_compartment_and_rootsock-scion.pdf", fig3, height = 6, width = 10)
